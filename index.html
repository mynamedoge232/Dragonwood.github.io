<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dragonwood</title>
<!-- Firebase Realtime Database -->
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database-compat.js"></script>
<style>
body { font-family: Georgia, 'Times New Roman', serif; }
:root {
  --gold: #d4a017; --gold-lt: #f0c84a; --gold-dk: #8a6510;
  --bg: #0b1a0b; --parch: #f0e2c0; --parch-dk: #c8a870;
}
*,*::before,*::after { box-sizing:border-box; margin:0; padding:0; }
html,body { height:100%; background:var(--bg); color:var(--parch); }
.screen { display:none; min-height:100vh; }
.screen.active { display:flex; }

/* ‚ïê‚ïê LOBBY SCREENS ‚ïê‚ïê */
#landing,#lobby-create,#lobby-join,#waiting {
  flex-direction:column; align-items:center; justify-content:center;
  padding:40px 20px;
  background:radial-gradient(ellipse at 50% 30%,#1a3a1a,#0b1a0b 70%);
}
.logo { text-align:center; margin-bottom:32px; }
.logo-icon { font-size:64px; display:block; margin-bottom:8px; }
.logo h1 { font-size:clamp(32px,8vw,68px); letter-spacing:.15em; color:var(--gold-lt); text-shadow:0 0 28px rgba(212,160,23,.4),0 2px 0 #000; font-variant:small-caps; }
.logo p  { font-size:12px; letter-spacing:.35em; color:var(--gold-dk); text-transform:uppercase; margin-top:5px; }

.card-box {
  background:linear-gradient(170deg,#1c3520,#0e1e10);
  border:1px solid var(--gold-dk); border-radius:16px; padding:34px 42px;
  width:100%; max-width:460px; box-shadow:0 20px 60px rgba(0,0,0,.6);
}
.card-box h2 { font-size:10px; letter-spacing:.3em; color:var(--gold-dk); text-transform:uppercase; margin-bottom:20px; text-align:center; }

.field-lbl { display:block; font-size:10px; letter-spacing:.2em; color:var(--gold-dk); text-transform:uppercase; margin-bottom:7px; }
.txt-input { width:100%; background:rgba(0,0,0,.35); border:1px solid rgba(212,160,23,.25); border-radius:8px; color:var(--parch); font-family:inherit; font-size:16px; padding:10px 14px; outline:none; transition:border-color .2s; margin-bottom:14px; }
.txt-input:focus { border-color:var(--gold); }

.gold-btn { width:100%; padding:14px; background:linear-gradient(180deg,var(--gold-lt),var(--gold) 55%,#906000); border:none; border-radius:10px; color:#1a0e00; font-family:inherit; font-size:15px; font-weight:bold; letter-spacing:.12em; cursor:pointer; text-transform:uppercase; transition:filter .2s,transform .15s; box-shadow:0 4px 18px rgba(212,160,23,.3); margin-bottom:10px; }
.gold-btn:hover { filter:brightness(1.12); transform:translateY(-2px); }
.gold-btn:active { transform:translateY(0); }
.gold-btn:disabled { opacity:.4; cursor:default; transform:none; filter:none; }

.ghost-btn { width:100%; padding:13px; background:transparent; border:1px solid var(--gold-dk); border-radius:10px; color:var(--gold-dk); font-family:inherit; font-size:14px; cursor:pointer; letter-spacing:.1em; transition:all .2s; }
.ghost-btn:hover { border-color:var(--gold); color:var(--gold-lt); background:rgba(212,160,23,.06); }

.divider { display:flex; align-items:center; gap:10px; margin:16px 0; color:var(--gold-dk); font-size:11px; letter-spacing:.2em; }
.divider::before,.divider::after { content:''; flex:1; height:1px; background:var(--gold-dk); opacity:.4; }

.mode-btns { display:flex; gap:10px; }
.mode-btn { flex:1; padding:28px 10px; background:rgba(0,0,0,.3); border:1px solid rgba(212,160,23,.2); border-radius:14px; color:var(--parch-dk); font-family:inherit; font-size:13px; cursor:pointer; transition:all .2s; text-align:center; letter-spacing:.05em; }
.mode-btn:hover { background:rgba(212,160,23,.08); border-color:var(--gold-dk); color:var(--parch); }
.mode-btn .mode-icon { font-size:36px; display:block; margin-bottom:10px; }
.mode-btn .mode-title { display:block; font-size:14px; font-weight:bold; margin-bottom:4px; color:var(--gold-lt); }
.mode-btn .mode-sub   { display:block; font-size:11px; opacity:.6; }

/* Room ID display */
.room-id-display {
  background:rgba(0,0,0,.4); border:2px solid var(--gold-dk); border-radius:12px;
  padding:20px; text-align:center; margin-bottom:20px;
}
.room-id-label { font-size:9px; letter-spacing:.3em; color:var(--gold-dk); text-transform:uppercase; margin-bottom:8px; }
.room-id-num { font-size:48px; font-weight:bold; color:var(--gold-lt); letter-spacing:.2em; font-variant:numeric; }
.room-id-hint { font-size:11px; color:rgba(255,255,255,.4); margin-top:8px; }

/* Waiting room players */
.player-slots { display:flex; flex-direction:column; gap:8px; margin-bottom:20px; }
.player-slot { display:flex; align-items:center; gap:10px; background:rgba(0,0,0,.3); border:1px solid rgba(255,255,255,.08); border-radius:8px; padding:10px 14px; }
.player-slot.filled { border-color:rgba(58,138,58,.4); background:rgba(20,60,20,.3); }
.player-slot.me { border-color:rgba(212,160,23,.4); background:rgba(40,30,5,.3); }
.slot-num { font-size:10px; color:var(--gold-dk); letter-spacing:.1em; width:26px; }
.slot-name { font-size:14px; flex:1; }
.slot-name.waiting { opacity:.35; font-style:italic; }
.slot-badge { font-size:9px; letter-spacing:.1em; text-transform:uppercase; }
.slot-badge.host { color:var(--gold-lt); }
.slot-badge.you  { color:#80ff80; }

.status-msg { font-size:12px; color:var(--gold-dk); text-align:center; margin-bottom:16px; letter-spacing:.08em; min-height:18px; }

.error-msg { font-size:12px; color:#ff8080; text-align:center; margin-bottom:12px; min-height:16px; }
.back-link { font-size:12px; color:var(--gold-dk); text-align:center; cursor:pointer; margin-top:14px; letter-spacing:.08em; transition:color .2s; }
.back-link:hover { color:var(--gold-lt); }

/* ‚ïê‚ïê GAME SCREEN ‚ïê‚ïê */
#game { flex-direction:column; background:var(--bg); background-image:radial-gradient(ellipse at 20% 60%,rgba(20,50,20,.35) 0%,transparent 55%),radial-gradient(ellipse at 80% 10%,rgba(10,25,10,.5) 0%,transparent 50%); }
.topbar { background:rgba(5,10,5,.97); border-bottom:1px solid rgba(212,160,23,.2); padding:8px 18px; display:flex; align-items:center; gap:16px; flex-wrap:wrap; position:sticky; top:0; z-index:50; }
.tb-title { font-size:16px; color:var(--gold); letter-spacing:.1em; font-variant:small-caps; }
.tb-turn  { flex:1; font-size:13px; color:#70e870; letter-spacing:.08em; }
.tb-turn.not-my-turn { color:#90a090; }
.tb-turn.wound-turn  { color:#ff8888; }
.tb-turn.ai-turn     { color:#ce93d8; }
.tb-decks { font-size:11px; color:var(--gold-dk); letter-spacing:.1em; }
.tb-room { font-size:10px; color:var(--gold-dk); letter-spacing:.1em; }
.score-chips { display:flex; gap:8px; flex-wrap:wrap; }
.chip { background:rgba(212,160,23,.08); border:1px solid rgba(212,160,23,.2); border-radius:20px; padding:3px 11px; font-size:11px; color:var(--gold-lt); letter-spacing:.05em; }
.chip.active { background:rgba(212,160,23,.22); border-color:var(--gold); }
.chip.me-chip { border-color:rgba(80,200,80,.35); }
.chip.me-chip.active { background:rgba(20,80,20,.4); border-color:#60cc60; color:#90ff90; }
.chip.ai-chip { border-color:rgba(138,47,201,.4); }
.chip.ai-chip.active { background:rgba(138,47,201,.25); border-color:#8b2fc9; color:#ce93d8; }

.game-body { display:grid; grid-template-columns:1fr 255px; flex:1; overflow:hidden; }
.g-left  { padding:14px; display:flex; flex-direction:column; gap:12px; overflow-y:auto; }
.g-right { background:rgba(5,10,5,.75); border-left:1px solid rgba(212,160,23,.12); padding:12px; display:flex; flex-direction:column; gap:14px; overflow-y:auto; }

.sec-lbl { font-size:9px; letter-spacing:.3em; color:var(--gold-dk); text-transform:uppercase; display:flex; align-items:center; gap:8px; margin-bottom:8px; }
.sec-lbl::after { content:''; flex:1; height:1px; background:linear-gradient(to right,var(--gold-dk),transparent); }

/* Dragonwood cards */
.landscape-row { display:flex; gap:10px; flex-wrap:wrap; }
.dw-card { width:138px; min-height:195px; border-radius:12px; padding:11px 10px; cursor:pointer; border-width:2px; border-style:solid; display:flex; flex-direction:column; gap:5px; flex-shrink:0; transition:transform .18s,box-shadow .18s; }
.dw-card:hover { transform:translateY(-5px); }
.dw-card.creature { background:linear-gradient(155deg,#1d5420,#0d2a0f); border-color:#3a8a3a; }
.dw-card.enhance  { background:linear-gradient(155deg,#3a1060,#180530); border-color:#8b2fc9; }
.dw-card.targeted { box-shadow:0 0 0 3px #ff4040,0 0 22px rgba(255,64,64,.45)!important; transform:translateY(-7px) scale(1.02); }
.dw-card.ai-eyeing{ box-shadow:0 0 0 2px #ce93d8,0 0 16px rgba(206,147,216,.3)!important; }
.dw-card.not-my-turn { cursor:default; }
.dw-card.not-my-turn:hover { transform:none; }

.c-badge { font-size:7px; letter-spacing:.18em; text-transform:uppercase; opacity:.7; margin-bottom:1px; }
.creature .c-badge { color:#80ff80; }
.enhance  .c-badge { color:#ce93d8; }
.c-name { font-size:11px; font-weight:bold; color:#fff; line-height:1.3; }
.c-vp { display:inline-flex; align-items:center; gap:3px; background:rgba(212,160,23,.15); border:1px solid var(--gold-dk); border-radius:14px; padding:1px 8px; font-size:11px; color:var(--gold-lt); width:fit-content; }
.c-effect { font-size:11px; color:#d0b0e0; line-height:1.4; flex:1; }
.c-perm   { font-size:8px; letter-spacing:.12em; color:#9c6aad; text-transform:uppercase; }
.c-divider { height:1px; background:rgba(255,255,255,.1); margin:3px 0; }
.attack-grid { display:flex; flex-direction:column; gap:4px; margin-top:auto; }
.atk-row { display:flex; align-items:center; justify-content:space-between; font-size:10px; letter-spacing:.05em; }
.atk-lbl { display:flex; align-items:center; gap:4px; }
.atk-strike .atk-lbl { color:#ef9a9a; } .atk-stomp .atk-lbl { color:#ffcc80; } .atk-scream .atk-lbl { color:#90caf9; }
.atk-num { font-size:15px; font-weight:bold; color:#fff; }

/* Action panel */
.action-panel { background:rgba(5,14,5,.85); border:1px solid rgba(212,160,23,.18); border-radius:14px; padding:13px 15px; }
.sel-info { font-size:13px; color:var(--parch-dk); background:rgba(0,0,0,.3); border-radius:8px; padding:7px 10px; min-height:32px; margin-bottom:11px; line-height:1.5; }
.sel-info b { color:var(--gold-lt); }
.wound-banner { background:linear-gradient(135deg,#5a0000,#380000); border:2px solid #cc0000; border-radius:10px; padding:10px 14px; margin-bottom:10px; text-align:center; font-size:12px; color:#ff8888; letter-spacing:.08em; display:none; animation:pulseBorder 1s ease infinite; }
.wound-banner.show { display:block; }
.ai-thinking { background:linear-gradient(135deg,#280848,#160328); border:1px solid rgba(138,47,201,.4); border-radius:10px; padding:9px 13px; margin-bottom:10px; font-size:12px; color:#ce93d8; letter-spacing:.06em; display:none; text-align:center; }
.ai-thinking.show { display:block; }
.waiting-turn-banner { background:rgba(0,0,0,.3); border:1px solid rgba(255,255,255,.08); border-radius:10px; padding:10px 14px; margin-bottom:10px; text-align:center; font-size:12px; color:#90a090; letter-spacing:.06em; display:none; }
.waiting-turn-banner.show { display:block; }

.btn-row { display:flex; gap:7px; flex-wrap:wrap; }
.btn { flex:1; min-width:80px; padding:10px 6px; border:none; border-radius:10px; font-family:inherit; font-size:11px; font-weight:bold; letter-spacing:.04em; cursor:pointer; display:flex; flex-direction:column; align-items:center; gap:3px; line-height:1.2; transition:filter .15s,transform .15s; }
.btn .bi { font-size:18px; } .btn .bs { font-size:8px; opacity:.7; }
.btn:hover:not(:disabled) { filter:brightness(1.2); transform:translateY(-2px); }
.btn:active:not(:disabled) { transform:translateY(0); }
.btn:disabled { opacity:.35; cursor:default; }
.btn-reload { background:linear-gradient(180deg,#455a64,#263238); color:#b0c0c8; }
.btn-strike { background:linear-gradient(180deg,#c62828,#7a0000); color:#ffcdd2; }
.btn-stomp  { background:linear-gradient(180deg,#6a1b9a,#36006a); color:#e1bee7; }
.btn-scream { background:linear-gradient(180deg,#1565c0,#0c2d6a); color:#bbdefb; }
.btn-clear  { background:linear-gradient(180deg,#424242,#1e1e1e); color:#9e9e9e; }

/* Hand */
.hand-lbl { font-size:9px; letter-spacing:.3em; color:var(--gold-dk); text-transform:uppercase; display:flex; align-items:center; gap:8px; margin-bottom:8px; }
.hand-lbl::after { content:''; flex:1; height:1px; background:linear-gradient(to right,var(--gold-dk),transparent); }
.hand-row { display:flex; gap:7px; flex-wrap:wrap; }
.adv-card { width:64px; height:90px; border-radius:10px; border:2px solid rgba(255,255,255,.15); display:flex; flex-direction:column; align-items:center; justify-content:center; cursor:pointer; transition:transform .15s,box-shadow .15s,border-color .15s; position:relative; overflow:hidden; user-select:none; }
.adv-card::after { content:''; position:absolute; inset:0; background:linear-gradient(135deg,rgba(255,255,255,.18) 0%,transparent 50%); pointer-events:none; }
.adv-card:hover:not(.in-wound):not(.no-interact) { transform:translateY(-9px); box-shadow:0 12px 28px rgba(0,0,0,.55); }
.adv-card.selected { border-color:var(--gold); box-shadow:0 0 0 3px var(--gold),0 0 18px rgba(212,160,23,.45); transform:translateY(-12px); }
.adv-card.in-wound:hover { border-color:#ff4444; box-shadow:0 0 0 3px #ff4444,0 0 18px rgba(255,68,68,.4); transform:translateY(-9px); }
.adv-card.no-interact { cursor:default; }
.s0{background:linear-gradient(155deg,#4a0080,#280050);}
.s1{background:linear-gradient(155deg,#1a5c1a,#0a3010);}
.s2{background:linear-gradient(155deg,#8b1a1a,#500a0a);}
.s3{background:linear-gradient(155deg,#b87e0b,#7a5200);}
.s4{background:linear-gradient(155deg,#0d5078,#063050);}
.adv-num  { font-size:22px; font-weight:bold; color:#fff; text-shadow:0 1px 4px rgba(0,0,0,.5); }
.adv-suit { font-size:8px; color:rgba(255,255,255,.7); letter-spacing:.06em; text-align:center; margin-top:1px; }

/* Right panel */
.rp-lbl { font-size:9px; letter-spacing:.28em; color:var(--gold-dk); text-transform:uppercase; margin-bottom:8px; display:flex; align-items:center; gap:8px; }
.rp-lbl::after { content:''; flex:1; height:1px; background:rgba(212,160,23,.18); }
.enh-owner { font-size:9px; color:var(--gold-dk); letter-spacing:.1em; text-transform:uppercase; margin:6px 0 4px; }
.enh-item { background:rgba(80,0,120,.28); border:1px solid rgba(139,47,201,.3); border-radius:8px; padding:6px 9px; margin-bottom:4px; }
.enh-item.used { opacity:.38; }
.enh-name { font-size:10px; color:#ce93d8; font-weight:bold; }
.enh-eff  { font-size:10px; color:#c0a0d0; }
.enh-tag  { font-size:8px; color:#9c6aad; letter-spacing:.1em; text-transform:uppercase; }
.no-enh   { font-size:11px; color:rgba(255,255,255,.2); font-style:italic; }
.enh-use-btn { display:inline-flex; align-items:center; gap:4px; margin-top:5px; padding:4px 9px; background:rgba(138,47,201,.2); border:1px solid rgba(138,47,201,.5); border-radius:6px; color:#ce93d8; font-size:10px; font-family:inherit; cursor:pointer; letter-spacing:.05em; transition:all .15s; }
.enh-use-btn:hover { background:rgba(138,47,201,.4); border-color:#8b2fc9; }
.enh-use-btn.btn-active { background:rgba(138,47,201,.6); border-color:#ce93d8; color:#fff; box-shadow:0 0 8px rgba(138,47,201,.5); }

.log-box { flex:1; min-height:160px; overflow-y:auto; background:rgba(0,0,0,.45); border-radius:10px; border:1px solid rgba(255,255,255,.05); padding:9px; font-size:11px; line-height:1.85; color:rgba(190,220,190,.8); }
.log-ok  { color:#70ff90; } .log-bad { color:#ff7070; } .log-evt { color:#ffb74d; }
.log-inf { color:#90caf9; } .log-ai  { color:#ce93d8; font-style:italic; }

/* Dice overlay */
#dice-overlay { position:fixed; inset:0; background:rgba(0,0,0,.92); display:none; flex-direction:column; align-items:center; justify-content:center; gap:20px; z-index:200; }
#dice-overlay.show { display:flex; }
.dice-who { font-size:11px; color:rgba(255,255,255,.4); letter-spacing:.15em; }
.dice-atk-lbl { font-size:13px; letter-spacing:.25em; color:var(--gold-dk); text-transform:uppercase; }
.dice-row { display:flex; gap:10px; flex-wrap:wrap; justify-content:center; }
.die { width:62px; height:62px; background:var(--parch); border-radius:12px; display:flex; align-items:center; justify-content:center; font-size:26px; font-weight:bold; color:#1a1000; box-shadow:0 4px 18px rgba(0,0,0,.5); animation:dieIn .35s ease; }
.die.rerolled { background:var(--gold-lt); }
.dice-total  { font-size:20px; color:var(--gold-lt); text-align:center; }
.dice-needed { font-size:14px; color:var(--parch-dk); }
.dice-outcome { font-size:32px; font-weight:bold; text-align:center; }
.dice-outcome.win  { color:#70ff90; }
.dice-outcome.lose { color:#ff6060; }
.dice-continue { padding:12px 30px; background:linear-gradient(180deg,var(--gold-lt),var(--gold)); border:none; border-radius:10px; font-family:inherit; font-size:14px; font-weight:bold; color:#1a0e00; cursor:pointer; letter-spacing:.1em; margin-top:6px; display:none; }
.dice-continue:hover { filter:brightness(1.1); }
.dice-watching { font-size:12px; color:rgba(255,255,255,.35); margin-top:4px; }

/* Game over */
#gameover-overlay { position:fixed; inset:0; background:rgba(0,0,0,.88); display:none; align-items:center; justify-content:center; z-index:300; }
#gameover-overlay.show { display:flex; }
.go-modal { background:linear-gradient(160deg,#1e3820,#0d1a0e); border:1px solid var(--gold-dk); border-radius:20px; padding:38px 46px; max-width:540px; width:92%; text-align:center; box-shadow:0 28px 90px rgba(0,0,0,.75); }
.go-modal h2 { font-size:28px; color:var(--gold-lt); margin-bottom:6px; }
.go-winner { font-size:16px; color:#80ff80; margin-bottom:26px; }
.go-table { width:100%; border-collapse:collapse; margin-bottom:18px; }
.go-table th { font-size:9px; letter-spacing:.2em; color:var(--gold-dk); text-transform:uppercase; padding:5px 8px; border-bottom:1px solid rgba(212,160,23,.2); text-align:left; }
.go-table td { padding:7px 8px; font-size:13px; border-bottom:1px solid rgba(255,255,255,.05); }
.go-table tr.w td { color:var(--gold-lt); font-weight:bold; }
.go-note { font-size:11px; color:rgba(255,255,255,.35); margin-bottom:24px; font-style:italic; }
.go-btn { padding:12px 28px; background:linear-gradient(180deg,var(--gold-lt),var(--gold)); border:none; border-radius:10px; font-family:inherit; font-size:13px; font-weight:bold; color:#1a0e00; cursor:pointer; letter-spacing:.1em; }
.go-btn:hover { filter:brightness(1.1); }

/* Count selector */
.count-row { display:flex; align-items:center; gap:14px; margin-bottom:18px; }
.cnt-btn { width:36px;height:36px;border-radius:50%;border:1px solid var(--gold-dk);background:rgba(212,160,23,.08);color:var(--gold-lt);font-size:20px;cursor:pointer;transition:background .15s; }
.cnt-btn:hover { background:rgba(212,160,23,.22); }
#cnt-display-online { font-size:26px; color:var(--gold-lt); min-width:32px; text-align:center; }
.cnt-label { color:var(--parch-dk); font-size:14px; }

@keyframes pulseBorder { 0%,100%{border-color:#cc0000;box-shadow:0 0 8px rgba(200,0,0,.3);}50%{border-color:#ff4444;box-shadow:0 0 20px rgba(255,68,68,.5);} }
@keyframes dieIn { from{transform:scale(.3) rotate(0deg);opacity:0;} to{transform:scale(1) rotate(720deg);opacity:1;} }
::-webkit-scrollbar{width:5px;} ::-webkit-scrollbar-track{background:rgba(0,0,0,.2);} ::-webkit-scrollbar-thumb{background:rgba(212,160,23,.2);border-radius:4px;}
@media(max-width:720px){ .game-body{grid-template-columns:1fr;} .g-right{border-left:none;border-top:1px solid rgba(212,160,23,.12);max-height:280px;} .dw-card{width:118px;} }
</style>
</head>
<body>

<!-- LANDING -->
<div id="landing" class="screen active">
  <div class="logo">
    <span class="logo-icon">üêâ</span>
    <h1>DRAGONWOOD</h1>
    <p>A Game of Dice &amp; Daring</p>
  </div>
  <div class="card-box">
    <h2>Choose Your Adventure</h2>
    <div class="mode-btns">
      <button class="mode-btn" onclick="showScreen('local-setup')">
        <span class="mode-icon">üñ•Ô∏è</span>
        <span class="mode-title">Local Game</span>
  
